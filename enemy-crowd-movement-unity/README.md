📁 대규모 적 유닛 겹침 방지 방식 정리
📌 개요
본 문서는 Unity 기반 대규모 유닛 게임(예: 뱀파이어 서바이벌류)에서
적 유닛의 겹침 방지 및 자연스러운 이동 제어를 위한 여러 알고리즘적 접근 방식을 정리한 자료입니다.

📂 1. RigidBody 기반 물리 충돌 방식
✅ 설명
Unity의 Rigidbody2D + Collider2D를 활용한 기본 물리 처리 방식

적들 간 충돌을 Unity 물리엔진에 맡김

✅ 장점
구현이 간단

Unity 물리 반응 자동 처리

❌ 단점
500~1000기 이상에서 성능 저하 심각

물리 반응 과도/튕김/진동 등 부자연스러움

📂 2. 후처리(사후 보정) 방식
✅ 설명
모든 적을 이동시킨 후, 서로 겹친 적끼리 거리를 확인해 밀어냄

다단계 밀어내기(Iterative Relaxation) 사용 가능

✅ 장점
직접 제어 가능

겹침 방지 확실함

❌ 단점
O(n²) 또는 O(n × 충돌 수) 연산량

밀림 파급효과 존재 (부자연스러움 발생 가능)

📂 3. 이동 전 충돌 예측 방식
✅ 설명
적이 이동하려는 방향에 장애물이 있을 경우 → 이동 취소 또는 방향 틀기

방향 수정 → 반복 검사 구조

✅ 장점
충돌 자체를 예방함

정지, 회피 등으로 자연스러움 유도 가능

❌ 단점
정체되는 적 많아질 수 있음

회피 실패 시 튕김 현상 or 멈춤 현상

📂 4. 포텐셜 필드(Potential Field) 방식
✅ 설명
플레이어는 끌어당기는 힘 (attractive)

다른 적들은 밀어내는 힘 (repulsive)

이 두 벡터의 합을 매 프레임 계산하여 이동

✅ 장점
매우 자연스러운 흐름

물리처럼 보이나 직접 제어 가능

AI스러운 이동 연출 가능

❌ 단점
기본 구현은 O(n²)

튀는 힘 방지 위해 클램핑, 반경 제한 필요

🔧 포텐셜 필드 + 최적화 구조
| 요소                | 설명                        |
| ----------------- | ------------------------- |
| Spatial Hashing   | 격자 분할로 근처 적만 계산 → O(n) 수준 |
| Influence Radius  | 특정 거리 이내 적만 힘 계산          |
| Distance Priority | 플레이어에 가까운 적 먼저 처리         |
| 단방향 상호작용          | 뒤쪽 적이 앞쪽 적에게 영향 주지 않음     |
| 힘 누적 제한           | ClampMagnitude 등 적용       |


📂 5. 혼합 방식 (Hybrid)
✅ 예시 구성
포텐셜 필드로 방향 계산

→ 이동 전 예측 충돌 검사

→ 사후 밀어내기 최소화

✅ 장점
자연스러움 + 충돌 안정성 + 성능 확보

대규모 적 제어에 가장 균형 잡힌 방식
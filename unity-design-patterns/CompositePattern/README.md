# 🌳 Composite Pattern in Unity

## 📖 개요

**Composite 패턴**은 객체를 **트리 구조로 구성**하여  
**단일 객체와 복합 객체(그룹)**를 **동일하게 처리할 수 있도록** 해주는 디자인 패턴입니다.

> 예: "출혈" 효과도 `Apply()`, "출혈 + 기절"도 `Apply()` 한 번으로 실행

---

## ✅ 유니티에서의 활용 예

| 예시                            | 설명 |
|----------------------------------|------|
| UI 트리 구조                     | 패널 → 버튼 → 텍스트 등 계층 구조 통합 처리
| 공격/효과 중첩 처리              | 여러 효과를 하나로 묶어 동시에 적용
| 오브젝트 그룹 처리               | 일괄 파괴, 일괄 활성화 등 처리
| AI 행동 트리 구성                | 복잡한 행동 흐름을 재귀적으로 구성

---

## 🧩 구조 구성

IAttackEffect         ← 인터페이스
   ↑
BleedEffect           ← Leaf: 단일 효과
StunEffect            ← Leaf: 단일 효과
CompositeEffect       ← Composite: 복합 효과 그룹

IAttackEffect는 공통 메서드인 Apply()를 정의

BleedEffect, StunEffect는 단일 효과

CompositeEffect는 IAttackEffect를 구현하고, 여러 IAttackEffect를 포함함

## 🧩 구조 구성

## ✅ 장점
| 장점                 | 설명                                    |
| ------------------ | ------------------------------------- |
| ✅ 일관된 사용 방식        | 단일/복합 객체 모두 동일한 인터페이스로 처리 (`Apply()`) |
| ✅ 트리 구조 표현 가능      | 재귀 구조이므로 계층적으로 구성 가능                  |
| ✅ 유연한 확장성          | 새로운 효과나 그룹을 쉽게 추가 가능                  |
| ✅ 개방-폐쇄 원칙(OCP) 만족 | 기존 코드 수정 없이 새로운 구성 가능                 |

## ❌ 단점
| 단점               | 설명                                    |
| ---------------- | ------------------------------------- |
| ❌ 클래스 수 증가       | 효과나 기능이 많아질수록 Leaf/Composite 클래스가 늘어남 |
| ❌ 디버깅 어려움        | 중첩된 Composite 안에서 어떤 객체가 실행됐는지 추적 어려움 |
| ❌ 단순한 경우엔 과도한 구조 | 작은 시스템에선 오히려 복잡함                      |

## 💡 기타 특징
재귀적으로 호출되는 구조이므로, Apply() 호출 시 모든 하위 효과가 실행됨

유니티 UI 계층 구조가 실제로 Composite 구조를 따르고 있음 (예: GameObject hierarchy)

## 🚨 주의할 점
성능 이슈: 깊은 트리 구조에서는 재귀 호출 비용 주의

순서 의존적 로직이면 Composite 구성 순서를 명확히 해야 함

Composite 안에 Composite가 반복되면 무한 루프 방지 체크 필요